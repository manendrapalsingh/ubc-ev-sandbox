apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "onix-bpp-kafka.fullname" . }}-bpp-config
  labels:
    {{- include "onix-bpp-kafka.labels" . | nindent 4 }}
    component: bpp
data:
  bppTxnCaller-routing.yaml: |
{{ .Values.config.routing.caller | indent 4 }}
  bppTxnReciever-routing.yaml: |
{{ .Values.config.routing.receiver | indent 4 }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "onix-bpp-kafka.fullname" . }}-bpp-adapter
  labels:
    {{- include "onix-bpp-kafka.labels" . | nindent 4 }}
    component: bpp
data:
  adapter.yaml: |
{{- $kafkaBroker := .Values.kafka.broker | default "kafka:9092" }}
{{- $redisHost := .Values.redis.host | default "redis:6379" }}
{{- $adapterConfig := .Values.config.adapter }}
{{- $adapterConfig = $adapterConfig | replace "KAFKA_BROKER_PLACEHOLDER" $kafkaBroker }}
{{- $adapterConfig = $adapterConfig | replace "REDIS_HOST_PLACEHOLDER" $redisHost }}
{{ $adapterConfig | indent 4 }}
