openapi: 3.0.3
info:
  title: BPP - EV Charging Network API
  description: |
    Beckn Provider Platform (BPP) API for EV Charging Network.
    
    **Asynchronous Communication Pattern:**
    - BPP receives requests from BAP and processes them asynchronously
    - BPP immediately returns an ACK (200 OK) or NAK (error response) to acknowledge receipt
    - ACK indicates the request was received and will be processed asynchronously
    - NAK indicates the request was rejected due to validation errors or other issues
    - Actual response data is sent asynchronously via callback endpoints to BAP's receiver
    
    **Callback Flow:**
    - BAP sends requests to BPP (via adapter/caller endpoints)
    - BPP immediately responds with ACK/NAK
    - BPP processes the request asynchronously
    - BPP sends callback responses to BAP receiver (e.g., on_discover, on_select, on_init)
    
    **Response Flow:**
    - On success: Returns 200 OK with an acknowledgment
    - On error: Returns appropriate HTTP error status (400, 500, etc.) with error details
    - Async responses: Actual business responses are delivered via callback endpoints to BAP receiver
  version: 1.0.0
  contact:
    name: EV Charging Network API Support
    email: support@evcharging.network

servers:
  - url: http://localhost:8082/bpp/receiver
    description: Local BPP Receiver (Development)
  - url: http://onix-bpp:8082/bpp/receiver
    description: BPP Receiver (Docker)
  - url: http://localhost:8082/bpp/caller
    description: Local BPP Caller (Development)
  - url: http://onix-bpp:8082/bpp/caller
    description: BPP Caller (Docker)

tags:
  - name: Discovery Callbacks
    description: Callback endpoints for discovery responses
  - name: Order Management Callbacks
    description: Callback endpoints for order lifecycle responses
  - name: Tracking Callbacks
    description: Callback endpoints for tracking responses
  - name: Support Callbacks
    description: Callback endpoints for support and rating responses
  - name: Catalog Publish
    description: Catalog publish and callback endpoints for catalog ingestion

paths:
  /on_discover:
    post:
      tags:
        - Discovery Callbacks
      summary: On Discover callback
      description: |
        Callback endpoint that sends catalog of available EV charging stations in response to a discover request.
        This is sent asynchronously by BPP to BAP receiver after processing the discover request.
        The BAP should acknowledge receipt with ACK/NAK.
      operationId: onDiscover
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnDiscoverRequest'
            examples:
              catalogResponse:
                summary: Catalog response with multiple charging stations
                value:
                  context:
                    version: "2.0.0"
                    action: "on_discover"
                    domain: "beckn.one:deg:ev-charging"
                    timestamp: "2024-01-15T10:30:05Z"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "a1eabf26-29f5-4a01-9d4e-4c5c9d1a3d02"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    catalogs:
                      - "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Catalog"
                        "beckn:id": "catalog-ev-charging-001"
                        "beckn:descriptor":
                          "@type": "beckn:Descriptor"
                          "schema:name": "EV Charging Services Network"
                          "beckn:shortDesc": "Comprehensive network of fast charging stations across Bengaluru"
                        "beckn:bppId": "bpp.ev-network.example.com"
                        "beckn:bppUri": "https://bpp.ev-network.example.com/bpp"
                        "beckn:items":
                          - "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                            "@type": "beckn:Item"
                            "beckn:id": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                            "beckn:descriptor":
                              "@type": "beckn:Descriptor"
                              "schema:name": "DC Fast Charger - CCS2 (60kW)"
                              "beckn:shortDesc": "High-speed DC charging station with CCS2 connector"
                            "beckn:category":
                              "@type": "schema:CategoryCode"
                              "schema:codeValue": "ev-charging"
                              "schema:name": "EV Charging"
                            "beckn:availabilityWindow":
                              - "@type": "beckn:TimePeriod"
                                "schema:startTime": "2026-01-04T08:00:00+05:30"
                                "schema:endTime": "2026-01-04T20:00:00+05:30"
                            "beckn:rateable": true
                            "beckn:rating":
                              "@type": "beckn:Rating"
                              "beckn:ratingValue": 4.5
                              "beckn:ratingCount": 128
                            "beckn:isActive": true
                            "beckn:provider":
                              "beckn:id": "ecopower-charging"
                              "beckn:descriptor":
                                "@type": "beckn:Descriptor"
                                "schema:name": "EcoPower Charging Pvt Ltd"
                            "beckn:itemAttributes":
                              "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingService/v1/context.jsonld"
                              "@type": "ChargingService"
                              connectorType: "CCS2"
                              maxPowerKW: 60
                              minPowerKW: 5
                              reservationSupported: true
                              chargingStation:
                                id: "IN-ECO-BTM-STATION-01"
                                serviceLocation:
                                  "@type": "beckn:Location"
                                  geo:
                                    type: "Point"
                                    coordinates: [77.5946, 12.9716]
                                  address:
                                    streetAddress: "EcoPower BTM Hub, 100 Ft Rd"
                                    addressLocality: "Bengaluru"
                                    addressRegion: "Karnataka"
                                    postalCode: "560076"
                                    addressCountry: "IN"
                              amenityFeature: ["RESTAURANT", "RESTROOM", "WI-FI"]
                              evseId: "IN*ECO*BTM*01*CCS2*A"
                              parkingType: "Mall"
                              powerType: "DC"
                              connectorFormat: "CABLE"
                              chargingSpeed: "FAST"
                              vehicleType: "4-WHEELER"
                        "beckn:offers":
                          - "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                            "@type": "beckn:Offer"
                            "beckn:id": "offer-ccs2-60kw-kwh"
                            "beckn:descriptor":
                              "@type": "beckn:Descriptor"
                              "schema:name": "Per-kWh Tariff - CCS2 60kW"
                            "beckn:items":
                              - "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                            "beckn:price":
                              currency: "INR"
                              value: 45.0
                              applicableQuantity:
                                unitText: "Kilowatt Hour"
                                unitCode: "KWH"
                                unitQuantity: 1
                            "beckn:validity":
                              "@type": "beckn:TimePeriod"
                              "schema:startDate": "2025-10-01T00:00:00Z"
                              "schema:endDate": "2026-03-31T23:59:59Z"
                            "beckn:acceptedPaymentMethod": ["UPI", "CREDIT_CARD", "WALLET"]
                            "beckn:offerAttributes":
                              "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingOffer/v1/context.jsonld"
                              "@type": "ChargingOffer"
                              tariffModel: "PER_KWH"
                              idleFeePolicy:
                                currency: "INR"
                                value: 2
                                applicableQuantity:
                                  unitCode: "MIN"
                                  unitText: "minutes"
                                  unitQuantity: 10
                            "beckn:provider": "ecopower-charging"
      responses:
        '200':
          description: ACK - Callback received and acknowledged
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request (validation error)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_select:
    post:
      tags:
        - Order Management Callbacks
      summary: On Select callback
      description: |
        Callback endpoint that sends order details with quote in response to a select request.
        This is sent asynchronously by BPP to BAP receiver after processing the select request.
      operationId: onSelect
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnSelectRequest'
            examples:
              selectResponse:
                summary: On select response with order and quote
                value:
                  context:
                    version: "2.0.0"
                    action: "on_select"
                    domain: "beckn.one:deg:ev-charging"
                    timestamp: "2024-01-15T10:30:05Z"
                    message_id: "bb9f86db-9a3d-4e9c-8c11-81c8f1a7b901"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:orderStatus": "CREATED"
                      "beckn:seller": "ecopower-charging"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:telephone": "+91-9876543210"
                        "beckn:email": "ravi.kumar@example.com"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                          "beckn:quantity":
                            unitText: "Kilowatt Hour"
                            unitCode: "KWH"
                            unitQuantity: 2.5
                          "beckn:acceptedOffer":
                            "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                            "@type": "beckn:Offer"
                            "beckn:id": "offer-ccs2-60kw-kwh"
                            "beckn:descriptor":
                              "@type": "beckn:Descriptor"
                              "schema:name": "Per-kWh Tariff - CCS2 60kW"
                            "beckn:items":
                              - "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                            "beckn:provider": "ecopower-charging"
                            "beckn:price":
                              currency: "INR"
                              value: 45.0
                              applicableQuantity:
                                unitText: "Kilowatt Hour"
                                unitCode: "KWH"
                                unitQuantity: 1
                          "beckn:price":
                            currency: "INR"
                            value: 45.0
                            applicableQuantity:
                              unitText: "Kilowatt Hour"
                              unitCode: "KWH"
                              unitQuantity: 1
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:orderAttributes":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingSession/v1/context.jsonld"
                        "@type": "ChargingSession"
                        buyerFinderFee:
                          feeType: "PERCENTAGE"
                          feeValue: 2.5
                        preferences:
                          startTime: "2026-01-04T08:00:00+05:30"
                          endTime: "2026-01-04T20:00:00+05:30"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_init:
    post:
      tags:
        - Order Management Callbacks
      summary: On Init callback
      description: |
        Callback endpoint that sends initialized order with quote and payment details in response to an init request.
        This is sent asynchronously by BPP to BAP receiver after processing the init request.
      operationId: onInit
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnInitRequest'
            examples:
              initResponse:
                summary: On init response with payment settlement details
                value:
                  context:
                    version: "2.0.0"
                    action: "on_init"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "6743e9e2-4fb5-487c-92b7-13ba8018f176"
                    timestamp: "2025-01-27T10:00:00Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "CREATED"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:telephone": "+91-9876543210"
                        "beckn:email": "ravi.kumar@example.com"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                          "beckn:quantity":
                            unitText: "Kilowatt Hour"
                            unitCode: "KWH"
                            unitQuantity: 2.5
                          "beckn:price":
                            currency: "INR"
                            value: 45.0
                            applicableQuantity:
                              unitText: "Kilowatt Hour"
                              unitCode: "KWH"
                              unitQuantity: 1
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:payment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Payment"
                        "beckn:id": "payment-123e4567-e89b-12d3-a456-426614174000"
                        "beckn:amount":
                          currency: "INR"
                          value: 143.95
                        "beckn:beneficiary": "BAP"
                        "beckn:paymentStatus": "INITIATED"
                        "beckn:paymentAttributes":
                          "@context": "https://raw.githubusercontent.com/bhim/ubc-tsd/main/beckn-schemas/UBCExtensions/v1/context.jsonld"
                          "@type": "UBCPaymentAttributes"
                          settlementAccounts:
                            - beneficiaryId: "example-bap.com"
                              accountHolderName: "Example BAP Solutions Pvt Ltd"
                              accountNumber: "9876543210123"
                              ifscCode: "HDFC0009876"
                              bankName: "HDFC Bank"
                              vpa: "example-bap@paytm"
                            - beneficiaryId: "example-bpp.com"
                              accountHolderName: "EcoPower Charging Solutions Pvt Ltd"
                              accountNumber: "1234567890123"
                              ifscCode: "HDFC0001234"
                              bankName: "HDFC Bank"
                              vpa: "ecopower@paytm"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_confirm:
    post:
      tags:
        - Order Management Callbacks
      summary: On Confirm callback
      description: |
        Callback endpoint that sends confirmed order details in response to a confirm request.
        This is sent asynchronously by BPP to BAP receiver after processing the confirm request.
      operationId: onConfirm
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnConfirmRequest'
            examples:
              confirmResponse:
                summary: On confirm response with confirmed order
                value:
                  context:
                    version: "2.0.0"
                    action: "on_confirm"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "c69b4c1e-fb7e-469d-ae90-00f4d5e82b64"
                    timestamp: "2025-01-27T10:05:00Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "PENDING"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:telephone": "+91-9876543210"
                        "beckn:email": "ravi.kumar@example.com"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                        "beckn:buyerAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/PaymentSettlement/v1/context.jsonld"
                          "@type": "BuyerPaymentInfo"
                          vpa: "ravikumar@upi"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                          "beckn:quantity":
                            unitText: "Kilowatt Hour"
                            unitCode: "KWH"
                            unitQuantity: 2.5
                          "beckn:price":
                            currency: "INR"
                            value: 45.0
                            applicableQuantity:
                              unitText: "Kilowatt Hour"
                              unitCode: "KWH"
                              unitQuantity: 1
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:payment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Payment"
                        "beckn:id": "payment-123e4567-e89b-12d3-a456-426614174000"
                        "beckn:amount":
                          currency: "INR"
                          value: 143.95
                        "beckn:paymentURL": "https://payments.bluechargenet-aggregator.io/pay?transaction_id=$transaction_id&amount=$amount"
                        "beckn:txnRef": "TXN-123456789"
                        "beckn:paidAt": "2025-12-19T10:05:00Z"
                        "beckn:beneficiary": "BPP"
                        "beckn:paymentStatus": "COMPLETED"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_update:
    post:
      tags:
        - Order Management Callbacks
      summary: On Update callback
      description: |
        Callback endpoint that sends updated order details in response to an update request.
        This is sent asynchronously by BPP to BAP receiver after processing the update request.
      operationId: onUpdate
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnUpdateRequest'
            examples:
              endChargingSession:
                summary: On update response when charging session ends
                value:
                  context:
                    version: "2.0.0"
                    action: "on_update"
                    domain: "beckn.one:deg:ev-charging"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "a1eabf26-29f5-4a01-9d4e-4c5c9d1a3d03"
                    timestamp: "2025-01-27T11:30:00Z"
                    ttl: "PT30S"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "INPROGRESS"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:telephone": "+91-9876543210"
                        "beckn:email": "ravi.kumar@example.com"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                        "beckn:buyerAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/PaymentSettlement/v1/context.jsonld"
                          "@type": "BuyerPaymentInfo"
                          vpa: "ravikumar@upi"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:fulfillment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Fulfillment"
                        "beckn:id": "fulfillment-001"
                        "beckn:mode": "RESERVATION"
                        "beckn:deliveryAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingSession/v1/context.jsonld"
                          "@type": "ChargingSession"
                          sessionStatus: "STOP"
                      "beckn:payment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Payment"
                        "beckn:id": "payment-123e4567-e89b-12d3-a456-426614174000"
                        "beckn:amount":
                          currency: "INR"
                          value: 143.95
                        "beckn:paymentURL": "https://payments.bluechargenet-aggregator.io/pay?transaction_id=$transaction_id&amount=$amount"
                        "beckn:txnRef": "TXN-123456789"
                        "beckn:paidAt": "2025-12-19T10:05:00Z"
                        "beckn:beneficiary": "BPP"
                        "beckn:paymentStatus": "COMPLETED"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_track:
    post:
      tags:
        - Tracking Callbacks
      summary: On Track callback
      description: |
        Callback endpoint that sends order tracking information in response to a track request.
        This is sent asynchronously by BPP to BAP receiver after processing the track request.
      operationId: onTrack
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnTrackRequest'
            examples:
              trackResponse:
                summary: On track response with charging telemetry
                value:
                  context:
                    version: "2.0.0"
                    action: "on_track"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "6ace310b-6440-4421-a2ed-b484c7548bd5"
                    timestamp: "2025-01-27T17:00:40.065Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "INPROGRESS"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:buyerAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/PaymentSettlement/v1/context.jsonld"
                          "@type": "BuyerPaymentInfo"
                          vpa: "ravikumar@upi"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                      "beckn:fulfillment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Fulfillment"
                        "beckn:id": "fulfillment-001"
                        "beckn:mode": "RESERVATION"
                        trackingAction:
                          "@type": "beckn:TrackAction"
                          target:
                            "@type": "schema:EntryPoint"
                            url: "https://track.bluechargenet-aggregator.io/session/SESSION-9876543210"
                        sessionStatus: "ACTIVE"
                        "beckn:deliveryAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingService/v1/context.jsonld"
                          "@type": "ChargingSession"
                          chargingTelemetry:
                            - eventTime: "2025-01-27T17:00:00Z"
                              metrics:
                                - name: "STATE_OF_CHARGE"
                                  value: 62.5
                                  unitCode: "PERCENTAGE"
                                - name: "POWER"
                                  value: 18.4
                                  unitCode: "KWH"
                                - name: "ENERGY"
                                  value: 10.2
                                  unitCode: "KW"
                                - name: "VOLTAGE"
                                  value: 392
                                  unitCode: "VLT"
                                - name: "CURRENT"
                                  value: 47.0
                                  unitCode: "AMP"
                            - eventTime: "2025-01-27T17:05:00Z"
                              metrics:
                                - name: "STATE_OF_CHARGE"
                                  value: 65.0
                                  unitCode: "PERCENTAGE"
                                - name: "POWER"
                                  value: 17.1
                                  unitCode: "KWH"
                                - name: "ENERGY"
                                  value: 11.1
                                  unitCode: "KW"
                                - name: "VOLTAGE"
                                  value: 388
                                  unitCode: "VLT"
                                - name: "CURRENT"
                                  value: 44.2
                                  unitCode: "AMP"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_cancel:
    post:
      tags:
        - Order Management Callbacks
      summary: On Cancel callback
      description: |
        Callback endpoint that sends cancellation confirmation in response to a cancel request.
        This is sent asynchronously by BPP to BAP receiver after processing the cancel request.
      operationId: onCancel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnCancelRequest'
            examples:
              cancelledSlot:
                summary: On cancel response for cancelled reservation
                value:
                  context:
                    version: "2.0.0"
                    domain: "beckn.one:deg:ev-charging"
                    action: "on_cancel"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "4a736341-8897-4e5a-9873-53533691f42d"
                    timestamp: "2025-01-27T10:05:00Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "CANCELLED"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                        "beckn:buyerAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/PaymentSettlement/v1/context.jsonld"
                          "@type": "BuyerPaymentInfo"
                          vpa: "ravikumar@upi"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "pe-charging-01"
                          "beckn:quantity":
                            unitText: "Kilowatt Hour"
                            unitCode: "KWH"
                            unitQuantity: 2.5
                          "beckn:price":
                            currency: "INR"
                            value: 45.0
                            applicableQuantity:
                              unitText: "Kilowatt Hour"
                              unitCode: "KWH"
                              unitQuantity: 1
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:payment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Payment"
                        "beckn:id": "payment-987e6543-e21b-34c5-b567-537725285111"
                        "beckn:amount":
                          currency: "INR"
                          value: 143.95
                        "beckn:paymentURL": "https://payments.bluechargenet-aggregator.io/pay?transaction_id=$transaction_id&amount=$amount"
                        "beckn:txnRef": "TXN-987654321"
                        "beckn:paidAt": "2025-12-19T17:35:00Z"
                        "beckn:beneficiary": "BUYER"
                        "beckn:paymentStatus": "REFUNDED"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_rating:
    post:
      tags:
        - Support Callbacks
      summary: On Rating callback
      description: |
        Callback endpoint that sends rating confirmation in response to a rating request.
        This is sent asynchronously by BPP to BAP receiver after processing the rating request.
      operationId: onRating
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnRatingRequest'
            examples:
              ratingReceived:
                summary: On rating response with feedback form
                value:
                  context:
                    version: "2.0.0"
                    action: "on_rating"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "89ee20fe-b592-48b0-a5c5-e38f6b90e569"
                    timestamp: "2025-01-27T12:00:30Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    received: true
                    feedbackForm:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Form"
                      url: "https://example-bpp.com/feedback/portal"
                      mime_type: "application/xml"
                      submission_id: "feedback-123e4567-e89b-12d3-a456-426614174000"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_support:
    post:
      tags:
        - Support Callbacks
      summary: On Support callback
      description: |
        Callback endpoint that sends support contact information in response to a support request.
        This is sent asynchronously by BPP to BAP receiver after processing the support request.
      operationId: onSupport
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnSupportRequest'
            examples:
              supportInfo:
                summary: On support response with contact details
                value:
                  context:
                    version: "2.0.0"
                    action: "on_support"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "dee432d9-36c9-4146-ad21-2f5bcac9b6a9"
                    timestamp: "2025-01-27T12:15:30Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    support:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:SupportInfo"
                      name: "BlueCharge Support Team"
                      phone: "18001080"
                      email: "support@bluechargenet-aggregator.io"
                      url: "https://support.bluechargenet-aggregator.io/ticket/SUP-20250730-001"
                      hours: "Mon–Sun 24/7 IST"
                      channels: ["PHONE", "EMAIL", "WEB", "CHAT"]
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /on_status:
    post:
      tags:
        - Tracking Callbacks
      summary: On Status callback
      description: |
        Callback endpoint that sends order status updates.
        This is sent asynchronously by BPP to BAP receiver for status notifications.
      operationId: onStatus
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OnStatusRequest'
            examples:
              chargingError:
                summary: On status callback for charging error
                value:
                  context:
                    version: "2.0.0"
                    action: "on_status"
                    domain: "beckn.one:deg:ev-charging"
                    bpp_id: "example-bpp.com"
                    bpp_uri: "https://example-bpp.com/bpp"
                    transaction_id: "2b4d69aa-22e4-4c78-9f56-5a7b9e2b2002"
                    message_id: "6743e9e2-4fb5-487c-92b7-13ba8018f176"
                    timestamp: "2025-01-27T13:07:02Z"
                    ttl: "PT30S"
                    bap_id: "example-bap.com"
                    bap_uri: "https://example-bap.com/bap"
                  message:
                    order:
                      "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                      "@type": "beckn:Order"
                      "beckn:id": "order-ev-charging-001"
                      "beckn:orderStatus": "INPROGRESS"
                      "beckn:seller": "cpo1.com"
                      "beckn:buyer":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Buyer"
                        "beckn:id": "user-123"
                        "beckn:role": "BUYER"
                        "beckn:displayName": "Ravi Kumar"
                        "beckn:telephone": "+91-9876543210"
                        "beckn:email": "ravi.kumar@example.com"
                        "beckn:taxID": "GSTIN29ABCDE1234F1Z5"
                        "beckn:buyerAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/PaymentSettlement/v1/context.jsonld"
                          "@type": "BuyerPaymentInfo"
                          vpa: "ravikumar@upi"
                      "beckn:orderItems":
                        - "beckn:orderedItem": "IND*ecopower-charging*cs-01*IN*ECO*BTM*01*CCS2*A*CCS2-A"
                      "beckn:orderValue":
                        currency: "INR"
                        value: 143.95
                        components:
                          - type: "UNIT"
                            value: 112.5
                            currency: "INR"
                            description: "Base charging session cost (45 INR/kWh × 2.5 kWh)"
                          - type: "SURCHARGE"
                            value: 20.0
                            currency: "INR"
                            description: "Surge price (20%)"
                          - type: "DISCOUNT"
                            value: -15.0
                            currency: "INR"
                            description: "Offer discount (15%)"
                          - type: "FEE"
                            value: 10.0
                            currency: "INR"
                            description: "Service fee"
                          - type: "FEE"
                            value: 13.64
                            currency: "INR"
                            description: "Overcharge estimation"
                          - type: "FEE"
                            value: 2.81
                            currency: "INR"
                            description: "Buyer finder fee (2.5%)"
                      "beckn:fulfillment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Fulfillment"
                        "beckn:id": "fulfillment-001"
                        "beckn:mode": "RESERVATION"
                        "beckn:deliveryAttributes":
                          "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/EvChargingSession/v1/context.jsonld"
                          "@type": "ChargingSession"
                          sessionStatus: "STOP"
                      "beckn:payment":
                        "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/main/schema/core/v2/context.jsonld"
                        "@type": "beckn:Payment"
                        "beckn:id": "payment-123e4567-e89b-12d3-a456-426614174000"
                        "beckn:amount":
                          currency: "INR"
                          value: 143.95
                        "beckn:paymentURL": "https://payments.bluechargenet-aggregator.io/pay?transaction_id=$transaction_id&amount=$amount"
                        "beckn:txnRef": "TXN-123456789"
                        "beckn:paidAt": "2025-12-19T10:05:00Z"
                        "beckn:beneficiary": "BPP"
                        "beckn:paymentStatus": "COMPLETED"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /beckn/v2/catalog/publish:
    post:
      tags:
        - Catalog Publish
      summary: Publish one or more catalogs for indexing
      description: |
        BPP submits catalogs to be indexed. Returns **ACK** immediately if accepted for processing.
        The detailed per-catalog processing result arrives later via **/on_catalog_publish**.
      operationId: publishCatalogs
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CatalogPublishRequest'
            examples:
              publishCatalog:
                summary: Publish EV charging catalog
                value:
                  context:
                    version: "2.0.0"
                    action: "catalog_publish"
                    timestamp: "2025-09-01T10:30:00+05:30"
                    message_id: "u-req-123"
                    transaction_id: "u-txn-123"
                    bpp_id: "bpp.example.com"
                    bpp_uri: "https://bpp.example.com/callbacks"
                    ttl: "PT30S"
                  catalogs:
                    - "@context": "https://becknprotocol.io/schemas/core/v1/Catalog/schema-context.jsonld"
                      "@type": "beckn:Catalog"
                      "beckn:id": "catalog-001"
                      "beckn:descriptor":
                        "@type": "beckn:Descriptor"
                        "schema:name": "BPP Test Catalog"
                      "beckn:items":
                        - "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/core/v2/context.jsonld"
                          "@type": "beckn:Item"
                          "beckn:id": "ev-charger-ccs2-001"
                          "beckn:descriptor":
                            "@type": "beckn:Descriptor"
                            "schema:name": "DC Fast Charger - CCS2 (60kW)"
                            "beckn:shortDesc": "High-speed DC charging station with CCS2 connector"
                          "beckn:category":
                            "@type": "schema:CategoryCode"
                            "schema:codeValue": "ev-charging"
                            "schema:name": "EV Charging"
                          "beckn:availableAt":
                            - geo:
                                type: "Point"
                                coordinates: [77.5946, 12.9716]
                              address:
                                streetAddress: "EcoPower BTM Hub, 100 Ft Rd"
                                addressLocality: "Bengaluru"
                                addressRegion: "Karnataka"
                                postalCode: "560076"
                                addressCountry: "IN"
                          "beckn:rateable": true
                          "beckn:isActive": true
                          "beckn:provider":
                            "beckn:id": "ecopower-charging"
                            "beckn:descriptor":
                              "@type": "beckn:Descriptor"
                              "schema:name": "EcoPower Charging Pvt Ltd"
                          "beckn:itemAttributes":
                            "@context": "https://raw.githubusercontent.com/beckn/protocol-specifications-new/refs/heads/draft/schema/EvChargingService/v1/context.jsonld"
                            "@type": "ChargingService"
                            connectorType: "CCS2"
                            maxPowerKW: 60
                            minPowerKW: 5
                            reservationSupported: true
                            parkingType: "Mall"
                            powerType: "DC"
                            connectorFormat: "CABLE"
                            chargingSpeed: "FAST"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /beckn/v2/catalog/on_publish:
    post:
      tags:
        - Catalog Publish
      summary: Callback with catalog publish processing results
      description: |
        Discovery Service calls back with per-catalog processing results (accepted/rejected, errors, derived stats).
        The receiver should respond with an **AckResponse**.
      operationId: onCatalogPublish
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CatalogPublishResponse'
            examples:
              publishResults:
                summary: Catalog publish results
                value:
                  context:
                    version: "2.0.0"
                    action: "on_catalog_publish"
                    timestamp: "2025-09-01T10:31:05+05:30"
                    message_id: "u-resp-123"
                    transaction_id: "u-txn-123"
                    bpp_id: "discovery-indexer.example.com"
                    bpp_uri: "https://discovery-indexer.example.com"
                    ttl: "PT30S"
                  message:
                    results:
                      - catalog_id: "catalog-001"
                        status: "ACCEPTED"
                        item_count: 42
                        warnings:
                          - code: "NON_NORMALIZED_BRAND"
                            message: "Some brand values were normalized"
                      - catalog_id: "catalog-002"
                        status: "REJECTED"
                        error:
                          code: "INVALID_ITEM"
                          message: "Invalid item payload at index 3"
                          paths: "catalogs[1].items[3]"
      responses:
        '200':
          description: ACK - Callback received
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AckResponse'
        '400':
          description: NAK - Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: NAK - Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    AckResponse:
      type: object
      properties:
        message:
          type: object
          properties:
            ack:
              type: object
              properties:
                status:
                  type: string
                  enum: ["ACK"]
                  description: Acknowledgment status
          required:
            - ack
      required:
        - message
      example:
        message:
          ack:
            status: "ACK"

    ErrorResponse:
      type: object
      properties:
        error:
          type: object
          properties:
            type:
              type: string
              description: Error type
            code:
              type: string
              description: Error code
            path:
              type: string
              description: Path to the error location
            message:
              type: string
              description: Error message
          required:
            - type
            - code
            - message

    Context:
      type: object
      properties:
        version:
          type: string
          description: Version of the Beckn protocol
          example: "2.0.0"
        action:
          type: string
          description: API endpoint callback
        domain:
          type: string
          description: Identifier of the domain
          example: "beckn.one:deg:ev-charging"
        bap_id:
          type: string
          description: Identification of the BAP
        bap_uri:
          type: string
          format: uri
          description: BAP endpoint
        bpp_id:
          type: string
          description: Identification of the BPP
        bpp_uri:
          type: string
          format: uri
          description: BPP endpoint
        transaction_id:
          type: string
          description: Transaction identifier
        message_id:
          type: string
          description: Message identifier
        timestamp:
          type: string
          format: date-time
          description: Time at which the response was generated
        ttl:
          type: string
          description: Time to live (ISO 8601 duration format)
          example: "PT30S"
        schema_context:
          type: array
          items:
            type: string
            format: uri
          description: Schema context URLs
      required:
        - version
        - action
        - domain
        - bap_id
        - bap_uri
        - bpp_id
        - bpp_uri
        - transaction_id
        - message_id
        - timestamp

    OnDiscoverRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            catalogs:
              type: array
              items:
                type: object
                description: Catalog object containing provider and items information
              minItems: 1
          required:
            - catalogs
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnSelectRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnInitRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnConfirmRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnUpdateRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnTrackRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            tracking:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                status:
                  type: string
            order:
              $ref: '#/components/schemas/Order'
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnStatusRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnCancelRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            order:
              $ref: '#/components/schemas/Order'
          required:
            - order
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnRatingRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            received:
              type: boolean
              description: Whether the rating was received
            feedbackForm:
              type: object
              properties:
                "@context":
                  type: string
                "@type":
                  type: string
                url:
                  type: string
                  format: uri
                mime_type:
                  type: string
                submission_id:
                  type: string
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    OnSupportRequest:
      type: object
      properties:
        context:
          $ref: '#/components/schemas/Context'
        message:
          type: object
          properties:
            support:
              type: object
              properties:
                "@context":
                  type: string
                "@type":
                  type: string
                name:
                  type: string
                  description: Support team name
                phone:
                  type: string
                  description: Support phone number
                email:
                  type: string
                  format: email
                  description: Support email address
                url:
                  type: string
                  format: uri
                  description: Support URI/ticket URL
                hours:
                  type: string
                  description: Support hours
                channels:
                  type: array
                  items:
                    type: string
                  description: Available support channels
        error:
          $ref: '#/components/schemas/ErrorDetail'
      required:
        - context
        - message

    CatalogPublishRequest:
      type: object
      required: [context, catalogs]
      properties:
        context:
          type: object
          required: [version, action, timestamp, message_id, transaction_id, bpp_id, bpp_uri, ttl]
          properties:
            version:
              type: string
              description: Version of the Beckn protocol
              example: "2.0.0"
            action:
              type: string
              enum: [catalog_publish]
              description: API endpoint action
            timestamp:
              type: string
              format: date-time
              description: Time at which the request was generated
            message_id:
              type: string
              description: Message identifier
            transaction_id:
              type: string
              description: Transaction identifier
            bpp_id:
              type: string
              description: Identification of the BPP
            bpp_uri:
              type: string
              format: uri
              description: BPP endpoint (where /on_catalog_publish callback is exposed)
            ttl:
              type: string
              description: Time to live (ISO 8601 duration format)
              example: "PT30S"
        catalogs:
          type: array
          description: Array of catalogs containing items
          items:
            type: object
            description: Catalog object containing provider and items information
          minItems: 1
      description: |
        Catalog Publish request envelope.
        *context.version* MUST indicate the supported protocol version (e.g., "2.0.0").

    CatalogPublishResponse:
      type: object
      required: [context, message]
      properties:
        context:
          allOf:
            - $ref: '#/components/schemas/Context'
            - type: object
              properties:
                action:
                  type: string
                  enum: [on_catalog_publish]
        message:
          type: object
          properties:
            results:
              type: array
              description: Per-catalog processing results
              items:
                $ref: '#/components/schemas/CatalogProcessingResult'

    CatalogProcessingResult:
      type: object
      required: [catalog_id, status]
      properties:
        catalog_id:
          type: string
          description: The "beckn:id" of the submitted catalog
        status:
          type: string
          enum: [ACCEPTED, REJECTED, PARTIAL]
          description: Final processing outcome for this catalog
        item_count:
          type: integer
          minimum: 0
          description: Number of items indexed (when accepted/partial)
        warnings:
          type: array
          description: Non-fatal issues encountered
          items:
            $ref: '#/components/schemas/ProcessingNotice'
        error:
          $ref: '#/components/schemas/ErrorDetail'

    ProcessingNotice:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: object
          additionalProperties: true

    Order:
      type: object
      description: Order object with varying structure based on callback endpoint
      properties:
        "@context":
          type: string
          format: uri
        "@type":
          type: string
          enum: ["beckn:Order"]
        "beckn:id":
          type: string
        "beckn:orderStatus":
          type: string
          enum: ["CREATED", "PENDING", "CONFIRMED", "ACTIVE", "INPROGRESS", "COMPLETED", "CANCELLED"]
        "beckn:orderNumber":
          type: string
        "beckn:seller":
          type: string
        "beckn:buyer":
          oneOf:
            - type: string
            - type: object
        "beckn:orderItems":
          type: array
          items:
            type: object
        "beckn:orderValue":
          type: object
          properties:
            currency:
              type: string
            value:
              type: number
            components:
              type: array
              items:
                type: object
        "beckn:fulfillment":
          type: object
        "beckn:payment":
          type: object
        "beckn:orderAttributes":
          type: object

    ErrorDetail:
      type: object
      properties:
        type:
          type: string
        code:
          type: string
        path:
          type: string
        message:
          type: string
